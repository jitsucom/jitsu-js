!function(){"use strict";var e=function(){return e=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},e.apply(this,arguments)};function t(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{c(i.next(e))}catch(e){r(e)}}function a(e){try{c(i.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))}function n(e,t){var n,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(e){r=[6,e],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}}function i(e,t,n){if(n||2===arguments.length)for(var i,o=0,r=t.length;o<r;o++)!i&&o in t||(i||(i=Array.prototype.slice.call(t,0,o)),i[o]=t[o]);return e.concat(i||Array.prototype.slice.call(t))}function o(e){void 0===e&&(e=void 0);var t=!!globalThis.window&&!!globalThis.window.document&&!!globalThis.window.location;return!t&&e&&l().warn(e),t}function r(e){if(void 0===e&&(e=void 0),!o())throw new Error(e||"window' is not available. Seems like this code runs outside browser environment. It shouldn't happen");return window}var s=function(){return"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope},a=function(){return o()||s()},c={DEBUG:{name:"DEBUG",severity:10},INFO:{name:"INFO",severity:100},WARN:{name:"WARN",severity:1e3},ERROR:{name:"ERROR",severity:1e4},NONE:{name:"NONE",severity:1e4}},u=null;function l(){return u||(u=p())}function p(e){var t=o()&&window.__eventNLogLevel,n=c.WARN;if(t){var r=c[t.toUpperCase()];r&&r>0&&(n=r)}else e&&(n=e);var s={minLogLevel:n};return Object.values(c).forEach((function(e){var t=e.name,o=e.severity;s[t.toLowerCase()]=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];if(o>=n.severity&&e.length>0){var s=e[0],a=e.splice(1),c="[J-".concat(t,"] ").concat(s);"DEBUG"===t||"INFO"===t?console.log.apply(console,i([c],a,!1)):"WARN"===t?console.warn.apply(console,i([c],a,!1)):console.error.apply(console,i([c],a,!1))}}})),function(e,t){if(o()){var n=window;n.__jitsuDebug||(n.__jitsuDebug={}),n.__jitsuDebug[e]=t}}("logger",s),s}function d(e,t,n){var i;void 0===n&&(n={});var o=e+"="+encodeURIComponent(t);if(o+="; Path="+(null!==(i=n.path)&&void 0!==i?i:"/"),n.maxAge&&(o+="; Max-Age="+Math.floor(n.maxAge)),n.domain&&(o+="; Domain="+n.domain),n.expires&&(o+="; Expires="+n.expires.toUTCString()),n.httpOnly&&(o+="; HttpOnly"),n.secure&&(o+="; Secure"),n.sameSite)switch("string"==typeof n.sameSite?n.sameSite.toLowerCase():n.sameSite){case!0:o+="; SameSite=Strict";break;case"lax":o+="; SameSite=Lax";break;case"strict":o+="; SameSite=Strict";break;case"none":o+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return o}var h;function f(e){if(!e)return{};for(var t={},n=e.split(";"),i=0;i<n.length;i++){var o=n[i],r=o.indexOf("=");r>0&&(t[o.substr(i>0?1:0,i>0?r-1:r)]=o.substr(r+1))}return t}function m(e,t){return Array.from(e.attributes).forEach((function(e){t.setAttribute(e.nodeName,e.nodeValue)}))}function v(e,t){e.innerHTML=t;var n,i=e.getElementsByTagName("script");for(n=i.length-1;n>=0;n--){var o=i[n],r=document.createElement("script");m(o,r),o.innerHTML&&(r.innerHTML=o.innerHTML),r.setAttribute("data-jitsu-tag-id",e.id),document.getElementsByTagName("head")[0].appendChild(r),i[n].parentNode.removeChild(i[n])}}var g=function(e){return e&&decodeURIComponent(r().document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},y=function(e,t,n){void 0===n&&(n={}),r().document.cookie=d(e,t,n)},_=function(e,t){void 0===t&&(t="/"),document.cookie=e+"= ; expires = Thu, 01 Jan 1970 00:00:00 GMT"+(t?"; path = "+t:"")},b=function(){return Math.random().toString(36).substring(2,12)},w=function(){return Math.random().toString(36).substring(2,7)},k={utm_source:"source",utm_medium:"medium",utm_campaign:"campaign",utm_term:"term",utm_content:"content"},P={gclid:!0,fbclid:!0,dclid:!0};var S=function(){function e(){this.queue=[]}return e.prototype.flush=function(){var e=this.queue;return this.queue=[],e},e.prototype.push=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];(e=this.queue).push.apply(e,t)},e}(),x=function(){function e(e){this.key=e}return e.prototype.flush=function(){var e=this.get();return e.length&&this.set([]),e},e.prototype.push=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this.get();n.push.apply(n,e),this.set(n)},e.prototype.set=function(e){localStorage.setItem(this.key,JSON.stringify(e))},e.prototype.get=function(){var e=localStorage.getItem(this.key);return null!==e&&""!==e?JSON.parse(e):[]},e}(),j="__buildEnv__",O="__buildDate__",A="".concat("__buildVersion__","/").concat(j,"@").concat(O),N=316224e3,C=function(e,t){l().debug("Sending beacon",t);var n=new Blob([t],{type:"text/plain"});return navigator.sendBeacon(e,n),Promise.resolve()};var E=function(e,t){return console.log("Jitsu client tried to send payload to ".concat(e),function(e){if("string"==typeof e)try{return JSON.stringify(JSON.parse(e),null,2)}catch(t){return e}}(t)),Promise.resolve()};function I(e,t){void 0===t&&(t=void 0),""!=(t=null!=t?t:window.location.pathname)&&"/"!=t&&(_(e,t),I(e,t.slice(0,t.lastIndexOf("/"))))}var T=function(){function e(e,t){this.cookieDomain=e,this.cookieName=t}return e.prototype.save=function(e){y(this.cookieName,JSON.stringify(e),{domain:this.cookieDomain,secure:"http:"!==document.location.protocol,maxAge:N})},e.prototype.restore=function(){I(this.cookieName);var e=g(this.cookieName);if(e)try{var t=JSON.parse(decodeURIComponent(e));return"object"!=typeof t?void l().warn("Can't restore value of ".concat(this.cookieName,"@").concat(this.cookieDomain,", expected to be object, but found ").concat("object"!=typeof t,": ").concat(t,". Ignoring")):t}catch(t){return void l().error("Failed to decode JSON from "+e,t)}},e.prototype.delete=function(){_(this.cookieName)},e}(),J=function(){function e(){}return e.prototype.save=function(e){},e.prototype.restore=function(){},e.prototype.delete=function(){},e}();var M={getSourceIp:function(){return"ip_policy"},describeClient:function(){return{referer:document.referrer,url:window.location.href,page_title:document.title,doc_path:document.location.pathname,doc_host:document.location.hostname,doc_search:window.location.search,screen_resolution:screen.width+"x"+screen.height,vp_size:Math.max(document.documentElement.clientWidth||0,window.innerWidth||0)+"x"+Math.max(document.documentElement.clientHeight||0,window.innerHeight||0),user_agent:navigator.userAgent,user_language:navigator.language,doc_encoding:document.characterSet}},getAnonymousId:function(e){var t=e.name,n=e.domain;I(t);var i=g(t);if(i)return l().debug("Existing user id",i),i;var o=b();return l().debug("New user id",o),y(t,o,{domain:n,secure:"http:"!==document.location.protocol,maxAge:N}),o}};var H={getSourceIp:function(){return"ip_policy"},describeClient:function(){return{}},getAnonymousId:function(){return""}},R=function(){return M},F=function(){return H},q=function(e,t,n,i){void 0===i&&(i=function(e,t){});var o=new window.XMLHttpRequest;return new Promise((function(r,s){o.onerror=function(n){l().error("Failed to send payload to ".concat(e,": ").concat((null==n?void 0:n.message)||"unknown error"),t,n),i(-1,{}),s(new Error("Failed to send JSON. See console logs"))},o.onload=function(){200!==o.status?(i(o.status,{}),l().warn("Failed to send data to ".concat(e," (#").concat(o.status," - ").concat(o.statusText,")"),t),s(new Error("Failed to send JSON. Error code: ".concat(o.status,". See logs for details")))):i(o.status,o.responseText),r()},o.open("POST",e),o.setRequestHeader("Content-Type","application/json"),Object.entries(n||{}).forEach((function(e){var t=e[0],n=e[1];return o.setRequestHeader(t,n)})),o.send(t),l().debug("sending json",t)}))},z=function(i){return function(o,r,s,a){return void 0===a&&(a=function(e,t){}),t(void 0,void 0,void 0,(function(){var t,c,u,p,d,h,f,m;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,i(o,{method:"POST",headers:e({Accept:"application/json","Content-Type":"application/json"},s||{}),body:r})];case 1:return t=n.sent(),[3,3];case 2:return c=n.sent(),l().error("Failed to send data to ".concat(o,": ").concat((null==c?void 0:c.message)||"unknown error"),r,c),a(-1,{}),[2];case 3:if(200!==t.status)return l().warn("Failed to send data to ".concat(o," (#").concat(t.status," - ").concat(t.statusText,")"),r),a(t.status,{}),[2];u={},p="",d=null!==(m=null===(f=t.headers)||void 0===f?void 0:f.get("Content-Type"))&&void 0!==m?m:"",n.label=4;case 4:return n.trys.push([4,6,,7]),[4,t.text()];case 5:return p=n.sent(),u=JSON.parse(p),[3,7];case 6:return h=n.sent(),l().error("Failed to parse ".concat(o," response. Content-type: ").concat(d," text: ").concat(p),h),[3,7];case 7:try{a(t.status,u)}catch(e){l().error("Failed to handle ".concat(o," response. Content-type: ").concat(d," text: ").concat(p),e)}return[2]}}))}))}},D=function(){function i(){this.userProperties={},this.permanentProperties={globalProps:{},propsPerEvent:{}},this.cookieDomain="",this.trackingHost="",this.idCookieName="",this.randomizeUrl=!1,this.apiKey="",this.initialized=!1,this._3pCookies={},this.cookiePolicy="keep",this.ipPolicy="keep",this.beaconApi=!1,this.transport=q,this.customHeaders=function(){return{}},this.queue=new S,this.maxSendAttempts=4,this.retryTimeout=[500,1e12],this.flushing=!1,this.attempt=1}return i.prototype.id=function(t,n){return this.userProperties=e(e({},this.userProperties),t),l().debug("Jitsu user identified",t),this.userIdPersistence?this.userIdPersistence.save(t):l().warn("Id() is called before initialization"),n?Promise.resolve():this.track("user_identify",{})},i.prototype.rawTrack=function(e){return this.sendJson(e)},i.prototype.makeEvent=function(t,n,i){var r,s=i.env,a=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n}(i,["env"]);s||(s=o()?R():F()),this.restoreId();var c=this.getCtx(s),u=e(e({},this.permanentProperties.globalProps),null!==(r=this.permanentProperties.propsPerEvent[t])&&void 0!==r?r:{}),l=e({api_key:this.apiKey,src:n,event_type:t},a),p=s.getSourceIp();return p&&(l.source_ip=p),this.compatMode?e(e(e({},u),{eventn_ctx:c}),l):e(e(e({},u),c),l)},i.prototype._send3p=function(e,t,n){var i="3rdparty";n&&""!==n&&(i=n);var o=this.makeEvent(i,e,{src_payload:t});return this.sendJson(o)},i.prototype.sendJson=function(e){return t(this,void 0,Promise,(function(){return n(this,(function(t){switch(t.label){case 0:return this.maxSendAttempts>1?(this.queue.push([e,0]),this.scheduleFlush(0),[3,3]):[3,1];case 1:return[4,this.doSendJson(e)];case 2:t.sent(),t.label=3;case 3:return[2]}}))}))},i.prototype.doSendJson=function(e){var t=this,n="keep"!==this.cookiePolicy?"&cookie_policy=".concat(this.cookiePolicy):"",i="keep"!==this.ipPolicy?"&ip_policy=".concat(this.ipPolicy):"",o=a()?"/api/v1/event":"/api/v1/s2s/event",r="".concat(this.trackingHost).concat(o,"?token=").concat(this.apiKey).concat(n).concat(i);this.randomizeUrl&&(r="".concat(this.trackingHost,"/api.").concat(w(),"?p_").concat(w(),"=").concat(this.apiKey).concat(n).concat(i));var s=JSON.stringify(e);return l().debug("Sending payload to ".concat(r),s),this.transport(r,s,this.customHeaders(),(function(e,n){return t.postHandle(e,n)}))},i.prototype.scheduleFlush=function(e){var t=this;if(!this.flushing){if(this.flushing=!0,void 0===e){var n=Math.random()+1,i=Math.pow(2,this.attempt++);e=Math.min(this.retryTimeout[0]*n*i,this.retryTimeout[1])}l().debug("Scheduling event queue flush in ".concat(e," ms.")),setTimeout((function(){return t.flush()}),e)}},i.prototype.flush=function(){return t(this,void 0,Promise,(function(){var e,t,i=this;return n(this,(function(n){switch(n.label){case 0:if(a()&&!globalThis.navigator.onLine&&(this.flushing=!1,this.scheduleFlush()),e=this.queue.flush(),this.flushing=!1,0===e.length)return[2];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.doSendJson(e.map((function(e){return e[0]})))];case 2:return n.sent(),this.attempt=1,l().debug("Successfully flushed ".concat(e.length," events from queue")),[3,4];case 3:return n.sent(),(e=e.map((function(e){return[e[0],e[1]+1]})).filter((function(e){return!(e[1]>=i.maxSendAttempts)||(l().error("Dropping queued event after ".concat(e[1]," attempts since max send attempts ").concat(i.maxSendAttempts," reached. See logs for details")),!1)}))).length>0?((t=this.queue).push.apply(t,e),this.scheduleFlush()):this.attempt=1,[3,4];case 4:return[2]}}))}))},i.prototype.postHandle=function(e,t){if("strict"===this.cookiePolicy||"comply"===this.cookiePolicy){if(200===e){var n=t;if("string"==typeof t&&(n=JSON.parse(t)),!n.delete_cookie)return}this.userIdPersistence.delete(),this.propsPersistance.delete(),_(this.idCookieName)}if(200===e){n=t;if("string"==typeof t&&t.length>0){var i=(n=JSON.parse(t)).jitsu_sdk_extras;if(i&&i.length>0)if(a())for(var o=0,r=i;o<r.length;o++){var s=r[o],c=s.type,u=s.id,p=s.value;if("tag"===c){var d=document.createElement("div");d.id=u,v(d,p),d.childElementCount>0&&document.body.appendChild(d)}}else l().error("Tags destination supported only in browser environment")}}},i.prototype.getCtx=function(t){var n,i,o=new Date,r=t.describeClient()||{};return e(e({event_id:"",user:e({anonymous_id:"strict"!==this.cookiePolicy?t.getAnonymousId({name:this.idCookieName,domain:this.cookieDomain}):""},this.userProperties),ids:this._getIds(),utc_time:(n=o.toISOString(),i=n.split(".")[1],i?i.length>=7?n:n.slice(0,-1)+"0".repeat(7-i.length)+"Z":n),local_tz_offset:o.getTimezoneOffset()},r),function(e){var t={utm:{},click_id:{}};for(var n in e)if(e.hasOwnProperty(n)){var i=e[n],o=k[n];o?t.utm[o]=i:P[n]&&(t.click_id[n]=i)}return t}(function(e){if(!e)return{};for(var t=e.length>0&&"?"===e.charAt(0)?e.substring(1):e,n={},i=("?"===t[0]?t.substr(1):t).split("&"),o=0;o<i.length;o++){var r=i[o].split("=");n[decodeURIComponent(r[0])]=decodeURIComponent(r[1]||"")}return n}(r.doc_search)))},i.prototype._getIds=function(){if(!o())return{};for(var e=function(e){if(void 0===e&&(e=!1),e&&h)return h;var t=f(document.cookie);return h=t,t}(!1),t={},n=0,i=Object.entries(e);n<i.length;n++){var r=i[n],s=r[0],a=r[1];this._3pCookies[s]&&(t["_"==s.charAt(0)?s.substr(1):s]=a)}return t},i.prototype.track=function(e,t){var n=t||{};l().debug("track event of type",e,n);var i=this.makeEvent(e,this.compatMode?"eventn":"jitsu",t||{});return this.sendJson(i)},i.prototype.init=function(e){var t,n,i,r,d,h,f=this;if(a()&&!e.force_use_fetch)e.fetch&&l().warn("Custom fetch implementation is provided to Jitsu. However, it will be ignored since Jitsu runs in browser"),this.transport=this.beaconApi?C:s()?z(globalThis.fetch):q;else{if(!e.fetch&&!globalThis.fetch)throw new Error("Jitsu runs in Node environment. However, neither JitsuOptions.fetch is provided, nor global fetch function is defined. \nPlease, provide custom fetch implementation. You can get it via node-fetch package");this.transport=z(e.fetch||globalThis.fetch)}if(e.custom_headers&&"function"==typeof e.custom_headers?this.customHeaders=e.custom_headers:e.custom_headers&&(this.customHeaders=function(){return e.custom_headers}),"echo"===e.tracking_host&&(l().warn('jitsuClient is configured with "echo" transport. Outgoing requests will be written to console'),this.transport=E),e.ip_policy&&(this.ipPolicy=e.ip_policy),e.cookie_policy&&(this.cookiePolicy=e.cookie_policy),"strict"===e.privacy_policy&&(this.ipPolicy="strict",this.cookiePolicy="strict"),e.use_beacon_api&&navigator.sendBeacon&&(this.beaconApi=!0),"comply"===this.cookiePolicy&&this.beaconApi&&(this.cookiePolicy="strict"),e.log_level&&(d=e.log_level,(h=c[d.toLocaleUpperCase()])||(console.warn("Can't find log level with name ".concat(d.toLocaleUpperCase(),", defaulting to INFO")),h=c.INFO),u=p(h)),this.initialOptions=e,l().debug("Initializing Jitsu Tracker tracker",e,A),e.key){if(this.compatMode=void 0!==e.compat_mode&&!!e.compat_mode,this.cookieDomain=e.cookie_domain||function(){if(o())return window.location.hostname.replace("www.","")}(),this.trackingHost=function(e){for(;n="/",-1!==(t=e).indexOf(n,t.length-n.length);)e=e.substr(0,e.length-1);var t,n;return 0===e.indexOf("https://")||0===e.indexOf("http://")?e:"https://"+e}(e.tracking_host||"t.jitsu.com"),this.randomizeUrl=e.randomize_url||!1,this.idCookieName=e.cookie_name||"__eventn_id",this.apiKey=e.key,"strict"===this.cookiePolicy?this.propsPersistance=new J:this.propsPersistance=o()?new T(this.cookieDomain,this.idCookieName+"_props"):new J,"strict"===this.cookiePolicy?this.userIdPersistence=new J:this.userIdPersistence=o()?new T(this.cookieDomain,this.idCookieName+"_usr"):new J,this.propsPersistance){var m=this.propsPersistance.restore();m&&(this.permanentProperties=m,this.permanentProperties.globalProps=null!==(t=m.globalProps)&&void 0!==t?t:{},this.permanentProperties.propsPerEvent=null!==(n=m.propsPerEvent)&&void 0!==n?n:{}),l().debug("Restored persistent properties",this.permanentProperties)}!1===e.capture_3rd_party_cookies?this._3pCookies={}:(e.capture_3rd_party_cookies||["_ga","_fbp","_ym_uid","ajs_user_id","ajs_anonymous_id"]).forEach((function(e){return f._3pCookies[e]=!0})),e.ga_hook&&l().warn("GA event interceptor isn't supported anymore"),e.segment_hook&&function(e){var t=window;t.analytics||(t.analytics=[]);e.interceptAnalytics(t.analytics)}(this),o()&&(e.disable_event_persistence||(this.queue=new x("jitsu-event-queue"),this.scheduleFlush(0)),window.addEventListener("beforeunload",(function(){return f.flush()}))),this.retryTimeout=[null!==(i=e.min_send_timeout)&&void 0!==i?i:this.retryTimeout[0],null!==(r=e.max_send_timeout)&&void 0!==r?r:this.retryTimeout[1]],e.max_send_attempts&&(this.maxSendAttempts=e.max_send_attempts),this.initialized=!0}else l().error("Can't initialize Jitsu, key property is not set")},i.prototype.interceptAnalytics=function(t){var n=this,i=function(t){var i;try{var o=e({},t.payload);l().debug("Intercepted segment payload",o.obj);var r=t.integrations["Segment.io"];if(r&&r.analytics){var s=r.analytics;"function"==typeof s.user&&s.user()&&"function"==typeof s.user().id&&(o.obj.userId=s.user().id())}(null===(i=null==o?void 0:o.obj)||void 0===i?void 0:i.timestamp)&&(o.obj.sentAt=o.obj.timestamp);var a=t.payload.type();"track"===a&&(a=t.payload.event()),n._send3p("ajs",o,a)}catch(e){l().warn("Failed to send an event",e)}t.next(t.payload)};"function"==typeof t.addSourceMiddleware?(l().debug("Analytics.js is initialized, calling addSourceMiddleware"),t.addSourceMiddleware(i)):(l().debug("Analytics.js is not initialized, pushing addSourceMiddleware to callstack"),t.push(["addSourceMiddleware",i])),t.__en_intercepted=!0},i.prototype.restoreId=function(){if(this.userIdPersistence){var t=this.userIdPersistence.restore();t&&(this.userProperties=e(e({},t),this.userProperties))}},i.prototype.set=function(t,n){var i,o=null==n?void 0:n.eventType,r=void 0===(null==n?void 0:n.persist)||(null==n?void 0:n.persist);if(void 0!==o){var s=null!==(i=this.permanentProperties.propsPerEvent[o])&&void 0!==i?i:{};this.permanentProperties.propsPerEvent[o]=e(e({},s),t)}else this.permanentProperties.globalProps=e(e({},this.permanentProperties.globalProps),t);this.propsPersistance&&r&&this.propsPersistance.save(this.permanentProperties)},i.prototype.unset=function(e,t){r();var n=null==t?void 0:t.eventType,i=void 0===(null==t?void 0:t.persist)||(null==t?void 0:t.persist);n?this.permanentProperties.propsPerEvent[n]&&delete this.permanentProperties.propsPerEvent[n][e]:delete this.permanentProperties.globalProps[e],this.propsPersistance&&i&&this.propsPersistance.save(this.permanentProperties)},i}();var L=["use_beacon_api","cookie_domain","tracking_host","cookie_name","key","ga_hook","segment_hook","randomize_url","capture_3rd_party_cookies","id_method","log_level","compat_mode","privacy_policy","cookie_policy","ip_policy","custom_headers","force_use_fetch","min_send_timeout","max_send_timeout","max_send_attempts","disable_event_persistence"];var U="data-suppress-interception-warning";function B(e){return"\n      ATTENTION! ".concat(e,"-hook set to true along with defer/async attribute! If ").concat(e," code is inserted right after Jitsu tag,\n      first tracking call might not be intercepted! Consider one of the following:\n       - Inject jitsu tracking code without defer/async attribute\n       - If you're sure that events won't be sent to ").concat(e," before Jitsu is fully initialized, set ").concat(U,'="true"\n       script attribute\n    ')}function G(e,t){l().debug("Processing queue",e);for(var n=0;n<e.length;n+=1){var o=i([],e[n],!0)||[],r=o[0],s=o.slice(1),a=t[r];"function"==typeof a&&a.apply(t,s)}e.length=0}if(window){var W=window,Q=function(e){var t=document.currentScript||document.querySelector("script[src*=jsFileName][data-jitsu-api-key]");if(t){var n,i={tracking_host:(n=t.getAttribute("src"),n.replace("/s/lib.js","").replace("/lib.js","")),key:null};L.forEach((function(e){var n="data-"+e.replace(new RegExp("_","g"),"-");if(void 0!==t.getAttribute(n)&&null!==t.getAttribute(n)){var o=t.getAttribute(n);"true"===o?o=!0:"false"===o&&(o=!1),i[e]=o}})),e.jitsuClient=function(e){var t=new D;return t.init(e),t}(i),!i.segment_hook||null===t.getAttribute("defer")&&null===t.getAttribute("async")||null!==t.getAttribute(U)||l().warn(B("segment")),!i.ga_hook||null===t.getAttribute("defer")&&null===t.getAttribute("async")||null!==t.getAttribute(U)||l().warn(B("ga"));var o=function(){var t=e.jitsuQ=e.jitsuQ||[];t.push(arguments),G(t,e.jitsuClient)};return e.jitsu=o,"true"!==t.getAttribute("data-init-only")&&"yes"!==t.getAttribute("data-init-only")&&o("track","pageview"),e.jitsuClient}l().warn("Jitsu script is not properly initialized. The definition must contain data-jitsu-api-key as a parameter")}(W);Q?(l().debug("Jitsu in-browser tracker has been initialized"),W.jitsu=function(){var e=W.jitsuQ=W.jitsuQ||[];e.push(arguments),G(e,Q)},W.jitsuQ&&(l().debug("Initial queue size of ".concat(W.jitsuQ.length," will be processed")),G(W.jitsuQ,Q))):l().error("Jitsu tracker has not been initialized (reason unknown)")}else l().warn("Jitsu tracker called outside browser context. It will be ignored")}();
